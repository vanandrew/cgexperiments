<html>
    <head>
        <link href="https://fonts.googleapis.com/css?family=Comfortaa:300" rel="stylesheet">
    </head>
    <body style="margin:0px 0px; background:black;">
        <div class="canvas-container" style="position:absolute; width:100%; height:100%;">
        </div>
        <div style="position:absolute; z-index:100; bottom:5%; left:5%;">
            <p style="font-family:'Comfortaa',cursive; color:white; font-size:72px;">greene lab</p>
            <p style="font-family:'Comfortaa',cursive; color:white; font-size:24px;">coming soon...</p>
        </div>
        <div style="position:absolute; z-index:100; bottom:5%; right:5%;">
            <!--button>Enter Site</button-->
        </div>

        <!-- Javascript -->
        <script src="lh.pial.json.js"></script>
        <script src="rh.pial.json.js"></script>
        <script src="lh.aparc.a2009s.annot.json.js"></script>
        <script src="rh.aparc.a2009s.annot.json.js"></script>
        <script
          src="https://code.jquery.com/jquery-3.2.1.min.js"
          integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
          crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/89/three.min.js"></script>
        <script src="OrbitControls.js"></script>
        <script>
        // Setup renderer
        var renderer = new THREE.WebGLRenderer();
        renderer.setSize($('body').width(),$('body').height());
        $('.canvas-container').append(renderer.domElement);

        // Setup scene
        var scene = new THREE.Scene();

        // Setup lighting
        var light = new THREE.PointLight(0xffffff,1,800);
        light.position.set(0, 300, 0);
        scene.add(light);
        var light = new THREE.PointLight(0xffffff,1,800);
        light.position.set(300, 0, 0);
        scene.add(light);
        var light = new THREE.PointLight(0xffffff,1,800);
        light.position.set(0, 0, 300);
        scene.add(light);
        var light = new THREE.PointLight(0xffffff,1,800);
        light.position.set(0, -300, 0);
        scene.add(light);
        var light = new THREE.PointLight(0xffffff,1,800);
        light.position.set(-300, 0, 0);
        scene.add(light);
        var light = new THREE.PointLight(0xffffff,1,800);
        light.position.set(0, 0, -300);
        scene.add(light);

        // Setup camera
        var camera = new THREE.PerspectiveCamera(75,$('body').width()/$('body').height(),0.1,1000);
        camera.position.z = 125;
        var controls = new THREE.OrbitControls(camera);

        // Make pial geometry for each hemisphere
        var left_pial = make_pial_geometry(data,lhcolor);
        var right_pial = make_pial_geometry(data2,rhcolor);
        scene.add(new THREE.Mesh(left_pial,new THREE.MeshStandardMaterial({vertexColors: THREE.VertexColors})));
        scene.add(new THREE.Mesh(right_pial,new THREE.MeshStandardMaterial({vertexColors: THREE.VertexColors})));

        // Render loop
        function animate() {
        	window.requestAnimationFrame(animate);
            controls.update();
            render();
        }
        animate();

        // Render function
        function render() {
            renderer.render(scene,camera);
        }

        // resize renderer and camera on window resize
        $(window).resize(function() {
            camera.aspect = $('body').width()/$('body').height();
            camera.updateProjectionMatrix();
            renderer.setSize($('body').width(),$('body').height());
        });

        // Draw pial surface geometry
        function make_pial_geometry(pialdata,hemicolor) {
            // Setup Geometry
            var geometry = new THREE.Geometry();
            for (var i = 0; i < pialdata.vertices.length; i++) {
                // Define vertices
                geometry.vertices.push(
                    new THREE.Vector3(
                        pialdata.vertices[i][1],
                        pialdata.vertices[i][2],
                        pialdata.vertices[i][0]
                    )
                );
            }
            for (var i = 0; i < pialdata.faces.length; i++) {
                // get color for each vertex
                let color0 = hemicolor['vertexcolor'][pialdata.faces[i][0]].slice(0,3);
                let color1 = hemicolor['vertexcolor'][pialdata.faces[i][1]].slice(0,3);
                let color2 = hemicolor['vertexcolor'][pialdata.faces[i][2]].slice(0,3);

                // Define faces
                geometry.faces.push(
                    new THREE.Face3(
                        pialdata.faces[i][1],
                        pialdata.faces[i][2],
                        pialdata.faces[i][0],
                        null,
                        [
                            new THREE.Color(color1[0]/255,color1[1]/255,color1[2]/255),
                            new THREE.Color(color2[0]/255,color2[1]/255,color2[2]/255),
                            new THREE.Color(color0[0]/255,color0[1]/255,color0[2]/255)
                        ]
                    )
                )
            }
            // compute vertex and face normals
            geometry.computeFaceNormals();
            geometry.computeVertexNormals();

            // return geometry
            return geometry;
        }
        </script>
    </body>
</html>
